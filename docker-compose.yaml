services:
  web:
    build:
      context: .
      dockerfile: Dockerfile.web
    env_file:
      - src/web/.env
    ports:
      - "$PORT:$PORT"

  web-local:
    build:
      context: .
      dockerfile: Dockerfile.web.local
    env_file:
      - src/web/.env
    ports:
      - "$PORT:$PORT"
    volumes:
      - ./src/web:/home/node/app
      - ./src/web/node_modules:/home/node/app/node_modules

  api:
    build:
      context: .
      dockerfile: Dockerfile.api
    env_file:
      - src/server/.env
    ports:
      - "$PORT:$PORT"

  api-local:
    build:
      context: .
      dockerfile: Dockerfile.api.local
    env_file:
      - src/server/.env
    ports:
      - "$PORT:$PORT"
    volumes:
      - ./src/server:/home/node/app
      - ./src/server/node_modules:/home/node/app/node_modules

  cron:
    build:
      context: .
      dockerfile: Dockerfile.cron
    env_file:
      - src/server/.env

  cron-local:
    build:
      context: .
      dockerfile: Dockerfile.cron.local
    env_file:
      - src/server/.env
    volumes:
      - ./src/server:/home/node/app
      - ./src/server/node_modules:/home/node/app/node_modules

  worker:
    build:
      context: .
      dockerfile: Dockerfile.worker
    env_file:
      - src/server/.env

  worker-local:
    build:
      context: .
      dockerfile: Dockerfile.worker.local
    env_file:
      - src/server/.env
    volumes:
      - ./src/server:/home/node/app
      - ./src/server/node_modules:/home/node/app/node_modules
